# Страница «Просмотр шаблона» (Admin) — только просмотр и публикация

**URL (пример):**

[https://same-7reptl57dew-latest.netlify.app/templates/use/employment-contract](https://same-7reptl57dew-latest.netlify.app/templates/use/employment-contract)

---

## Связанные страницы

- [Редактирование шаблона (Admin)](%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0%20%C2%AB%D0%A0%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%B0%C2%BB%20(Admin)%2028aeb7bb740980899c14e7304dd6f285.md) — править атрибуты перед публикацией.
- [Реквизиты шаблона (Admin)](%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0%20%C2%AB%D0%A0%D0%B5%D0%BA%D0%B2%D0%B8%D0%B7%D0%B8%D1%82%D1%8B%20%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%B0%C2%BB%20(Admin)%2028aeb7bb740980259c6bc2f927c441ac.md) — проверить/назначить требуемые поля.
- [Страница с шаблонами](../%D0%9A%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%20%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2%20(Admin)%20290eb7bb740980fbb1f9e84a8df0ee21/%D0%9A%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%20%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2%20%E2%80%94%20%D0%90%D0%B4%D0%BC%D0%B8%D0%BD%20(Admin)%2028aeb7bb740980fcac13d4842d08e63d.md) — результат публикации виден в каталоге.
- [Список шаблонов](../%D0%9A%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%20%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2%20(Admin)%20290eb7bb740980fbb1f9e84a8df0ee21/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA%20%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2%2028aeb7bb74098091a381ef6ae73e0297.md) — сверить метаданные/статусы.

## Назначение

Read-only экран для администратора с **двумя задачами**:

1. посмотреть атрибуты шаблона;
2. **опубликовать / снять с публикации** шаблон.

**Дополнительная явная цель экрана (прозрачность назначения):**

- Экран используется **для просмотра УЖЕ ОПУБЛИКОВАННЫХ шаблонов** (чтобы видеть их атрибуты в актуальном состоянии).
- Экран используется **для публикации ранее созданных, но ещё НЕ ОПУБЛИКОВАННЫХ шаблонов** (перевод из статуса «Не опубликован» в «Опубликован»).

> Никакого редактирования контента на этой странице. Любые правки делаются на странице «Настройки шаблона».
> 

---

## Доступ

Только **админ**.

---

## Макет (desktop)

**Хедер**

- Название (RU)
- Бейдж статуса публикации: **Опубликован** / **Не опубликован**
- `version` (например, `v1.0`)
- `code` (моно: `employment_contract`)

**Контент (read-only блок)**

- Пояснение (короткое «зачем нужен документ»)
- Категория (1 шт., из справочника)
- Теги (до **5**; порядок сохранён)
- Маршрут: бейдж
    
    — `hasBodyChat=true`: «Тело формируется в чате (реквизиты не отправляются в ИИ)»
    
    — `hasBodyChat=false`: «Сразу к привязке реквизитов»
    

**Панель действий**

- Кнопка **Опубликовать** / **Снять с публикации** (в зависимости от состояния)
- Кнопка **Назад к каталогу**

---

## Публикация — правила и поведение

### Кнопка и состояния

- Если `isEnabled=false` → показать **Опубликовать** (primary).
- Если `isEnabled=true` → показать **Снять с публикации** (danger/secondary).
- 

**Блок статуса перед публикацией**

> Статус реквизитов: назначены / не назначены
> 
> 
> Если реквизиты **не назначены** — публикация недоступна.
> 
> Кнопки:
> 
> • **«Назначить реквизиты»** — перейти к настройке (для неназначенных).
> 
> • **«Редактировать реквизиты»** — изменить текущий список (если назначены).
> 

### Проверки перед публикацией (блокирующие)

При нажатии **Опубликовать** выполняются проверки:

1. Есть **Название (RU)**
2. Заполнен **code** (валидный `snake_case`)
3. Заполнено **Пояснение** (короткий текст)
4. Выбрана **Категория** (ровно 1 из справочника)
5. Выбраны **Теги** (≥1 из справочника; максимум 5 уже обеспечивается на этапе создания/настройки)
6. Задан **version** (SemVer вида `vMAJOR.MINOR[.PATCH]`)
7. Установлен **hasBodyChat** (Да/Нет)

Если что-то из этого отсутствует → показать модал «Нельзя опубликовать. Заполните обязательные поля на странице настройки шаблона.» с единственной кнопкой **Перейти к настройке**.

### Подтверждение действия

- **Опубликовать** → модал подтверждения:
    
    «Сделать шаблон доступным пользователям в каталоге?»
    
    Кнопки: **Опубликовать** / Отмена
    
- **Снять с публикации** → модал подтверждения:
    
    «Скрыть шаблон из каталога для пользователей?»
    
    Кнопки: **Снять с публикации** / Отмена
    

### Результат

- Успех: тост «Статус обновлён», бейдж и кнопка меняют состояние.
- Ошибка: тост с текстом ошибки; состояние не меняется.

---

## Состояния экрана

### Не опубликован (`isEnabled=false`)

- Бейдж: **Не опубликован** (серый).
- Кнопка: **Опубликовать**.
- Текст-подсказка под бейджем: «Недоступен пользователям в каталоге».

### Опубликован (`isEnabled=true`)

- Бейдж: **Опубликован** (зелёный).
- Кнопка: **Снять с публикации**.
- Текст-подсказка под бейджем: «Доступен пользователям в каталоге».

---

## Критерии приёмки (QA)

1. Все поля отображаются read-only: Название, `code`, `version`, Пояснение, Категория, до 5 тегов, Маршрут.
2. Кнопка публикации корректно меняет состояние и бейдж после подтверждения.
3. Перед публикацией выполняются все блокирующие проверки; при отсутствии данных выдаётся модал с переходом на «Настройки шаблона».
4. «Назад к каталогу» возвращает на список шаблонов.
5. Никакого редактирования полей на этом экране нет.
6. Экран используется **как для просмотра уже опубликованных шаблонов**, так и **для публикации ранее созданных (не опубликованных) шаблонов** — это отражено в тексте назначения и проверяется в обоих состояниях (`isEnabled=true/false`).