# üîç –¢–û–¢–ê–õ–¨–ù–´–ô –ê–£–î–ò–¢ –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–ò –°–ê–ô–¢–ê

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2025-01-28  
**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:** –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
**–û–±—ä—ë–º –∞–Ω–∞–ª–∏–∑–∞:** –í—Å—è –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞

---

## üìä –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | 8.5/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | 8/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **API –∏ –º–∞—Ä—à—Ä—É—Ç—ã** | 7.5/10 | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π |
| **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** | 8/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **–ú–æ–¥–µ–ª–∏ –∏ –¥–∞–Ω–Ω—ã–µ** | 9/10 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **–í–∞–ª–∏–¥–∞—Ü–∏–∏** | 8.5/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã** | 7/10 | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π |
| **–¢–µ—Å—Ç—ã** | 0/10 | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 7/10 | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | 8/10 | ‚úÖ –•–æ—Ä–æ—à–æ |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 7.3/10

---

## 1. üß© –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

### –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–¢–∏–ø:** Next.js Full-Stack –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–º–æ–Ω–æ–ª–∏—Ç)
- **Frontend:** React + Next.js 15 (App Router)
- **Backend:** Next.js API Routes
- **ORM:** Prisma
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL (Neon serverless)
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** React Query (TanStack Query)

### –°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         UI Layer (React)            ‚îÇ  ‚Üê –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ  - src/app/*/page.tsx               ‚îÇ
‚îÇ  - src/components/**                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      API Layer (Next.js Routes)     ‚îÇ  ‚Üê REST API endpoints
‚îÇ  - src/app/api/**/route.ts          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Service Layer (Utils)          ‚îÇ  ‚Üê –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ  - src/lib/auth-utils.ts            ‚îÇ
‚îÇ  - src/lib/services/openai.ts       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Data Layer (Prisma)            ‚îÇ  ‚Üê –î–æ—Å—Ç—É–ø –∫ –ë–î
‚îÇ  - src/lib/prisma.ts                ‚îÇ
‚îÇ  - prisma/schema.prisma              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤

| –ü—Ä–∏–Ω—Ü–∏–ø | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|--------|-------------|
| **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤** | ‚úÖ | –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ UI ‚Üí API ‚Üí Service ‚Üí Data |
| **SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã** | ‚ö†Ô∏è | –ï—Å—Ç—å —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ API routes (SRP –Ω–∞—Ä—É—à–µ–Ω —á–∞—Å—Ç–∏—á–Ω–æ) |
| **DRY (Don't Repeat Yourself)** | ‚úÖ | –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã (auth-utils, validators) |
| **KISS (Keep It Simple)** | ‚úÖ | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è |
| **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | ‚úÖ | –ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ |

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–°–º–µ—à–∏–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ API routes**
   - –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö routes –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
   - **–ü—Ä–∏–º–µ—Ä:** `src/app/api/documents/route.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å–º–µ—à–∞–Ω–∞ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –≤ —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DocumentService.create()`)

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –µ–¥–∏–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ—à–∏–±–æ–∫**
   - –ö–∞–∂–¥—ã–π route –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å middleware –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

---

## 2. üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø –ò –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

**–¢–∏–ø:** JWT —Ç–æ–∫–µ–Ω—ã (access + refresh)

**–ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–æ–¥ –ø–æ email (`/api/auth/send-code`)
2. –ü–æ–ª—É—á–∞–µ—Ç 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
3. –í–≤–æ–¥–∏—Ç –∫–æ–¥ (`/api/auth/verify-code`)
4. –ü–æ–ª—É—á–∞–µ—Ç access token (15 –º–∏–Ω—É—Ç) + refresh token (7 –¥–Ω–µ–π) –≤ HttpOnly cookies
5. –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ access token –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è refresh token (`/api/auth/refresh`)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π

**–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π:**
- `user` - –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `admin` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ADMIN_EMAIL`)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π:**
- ‚úÖ Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—É—Ç–µ–π
- ‚úÖ –ö–∞–∂–¥—ã–π API route –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å —á–µ—Ä–µ–∑ `getCurrentUser()`
- ‚úÖ –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ö–æ–¥ middleware

### –ü—Ä–æ–±–ª–µ–º—ã –∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è access token** | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ middleware |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è refresh token** | ‚úÖ | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –ë–î –ø—Ä–∏ refresh |
| **–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞** | ‚ö†Ô∏è | –í `env`, –Ω–æ –Ω–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ |
| **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ–±—Ö–æ–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π** | ‚úÖ | –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (middleware + route) |
| **–†–æ—Ç–∞—Ü–∏—è refresh —Ç–æ–∫–µ–Ω–æ–≤** | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ env) |
| **–û—Ç–∑—ã–≤ —Ç–æ–∫–µ–Ω–æ–≤** | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `revoked` —Ñ–ª–∞–≥ |
| **Timing attacks –Ω–∞ email** | ‚úÖ | –ó–∞—â–∏—Ç–∞ –µ—Å—Ç—å –≤ `send-code` (–æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞) |

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ JWT_SECRET –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ**
   - –ï—Å–ª–∏ `JWT_SECRET` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
   - **–ö–æ–¥:** `src/lib/jwt.ts:5-7` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
   - **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

2. **Refresh token —Ä–æ—Ç–∞—Ü–∏—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞**
   - –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ `ROTATE_REFRESH_TOKENS=false`
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í production –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–∞—Ç—å —Ä–æ—Ç–∞—Ü–∏—é

3. **–ù–µ—Ç –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç—ë–∫—à–∏—Ö refresh —Ç–æ–∫–µ–Ω–æ–≤**
   - –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `cleanupExpiredRefreshTokens()` –≤ `auth-utils.ts:390`, –Ω–æ –æ–Ω–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron job –∏–ª–∏ –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º refresh

---

## 3. üì° API –ò –ú–ê–†–®–†–£–¢–´

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ endpoints

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ `POST /api/auth/send-code` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞
- ‚úÖ `POST /api/auth/verify-code` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ `POST /api/auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token
- ‚úÖ `POST /api/auth/logout` - –≤—ã—Ö–æ–¥

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- ‚úÖ `GET /api/users/me` - –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `PUT /api/users/me` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ `POST /api/users/verify-email-change` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–º–µ–Ω—ã email

#### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `GET /api/organizations` - —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- ‚úÖ `POST /api/organizations` - —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `GET /api/organizations/[id]` - –¥–µ—Ç–∞–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `PUT /api/organizations/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `DELETE /api/organizations/[id]` - —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

#### –î–æ–∫—É–º–µ–Ω—Ç—ã
- ‚úÖ `GET /api/documents` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ `POST /api/documents` - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ `GET /api/documents/[id]` - –¥–µ—Ç–∞–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ `PUT /api/documents/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ `DELETE /api/documents/[id]` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ `POST /api/documents/generate-pdf` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
- ‚úÖ `POST /api/documents/generate-docx` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è DOCX

#### –ò–ò —á–∞—Ç
- ‚úÖ `POST /api/ai/chat` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ OpenAI

#### –§–∞–π–ª—ã
- ‚úÖ `POST /api/files/parse` - –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤ (DOCX, PDF, TXT)

#### –ê–¥–º–∏–Ω–∫–∞
- ‚úÖ `GET /api/admin/access` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º
- ‚úÖ `GET /api/admin/access/[userId]` - –¥–µ—Ç–∞–ª–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `POST /api/admin/access/[userId]` - –≤—ã–¥–∞—á–∞/–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ `DELETE /api/admin/access/[userId]` - –æ—Ç–∑—ã–≤ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ `GET /api/admin/access/search` - –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `GET /api/admin/templates` - —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤
- ‚úÖ `POST /api/admin/templates` - —Å–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ `GET /api/admin/templates/[code]` - –¥–µ—Ç–∞–ª–∏ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ `PUT /api/admin/templates/[code]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ `DELETE /api/admin/templates/[code]` - —É–¥–∞–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ `GET /api/admin/template-configs/[code]` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ `PUT /api/admin/template-configs/[code]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### –®–∞–±–ª–æ–Ω—ã (–ø—É–±–ª–∏—á–Ω—ã–µ)
- ‚úÖ `GET /api/templates` - —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP –º–µ—Ç–æ–¥–æ–≤ –∏ –∫–æ–¥–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| **GET/POST —Å–∏–º–º–µ—Ç—Ä–∏—è** | ‚úÖ | –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã |
| **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã** | ‚úÖ | GET, POST, PUT, DELETE –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| **–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤** | ‚ö†Ô∏è | –ï—Å—Ç—å, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä |
| **400 Bad Request** | ‚úÖ | –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 400 |
| **401 Unauthorized** | ‚úÖ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–∫–µ–Ω–∞ |
| **403 Forbidden** | ‚úÖ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –ø—Ä–∞–≤–∞—Ö |
| **404 Not Found** | ‚úÖ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ—Å—É—Ä—Å–∞ |
| **429 Too Many Requests** | ‚úÖ | Rate limiting –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 429 |
| **500 Internal Server Error** | ‚úÖ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ catch –±–ª–æ–∫–∞—Ö |

### –ü—Ä–æ–±–ª–µ–º—ã

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**
   - `GET /api/documents` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - `GET /api/organizations` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   - `GET /api/admin/access` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `page` –∏ `limit`

2. **–ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏**
   - –í—Å–µ —Å–ø–∏—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å query parameters –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

3. **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ Prisma**
   - Unique constraint violations –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ (–∫—Ä–æ–º–µ `POST /api/admin/templates`)
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å `P2002` –æ—à–∏–±–∫–∏ Prisma

4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è API**
   - –í—Å–µ endpoints –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ `/api/*` –±–µ–∑ –≤–µ—Ä—Å–∏–∏
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `/api/v1/*` –¥–ª—è –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## 4. üß† –ë–ò–ó–ù–ï–°-–õ–û–ì–ò–ö–ê

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (`accessFrom`, `accessUntil`)
- ‚úÖ –î–µ–º–æ-–ª–∏–º–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–µ–º–æ-–ª–∏–º–∏—Ç

#### –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á—ë—Ç—á–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –°–º–µ–Ω–∞ email —Ç—Ä–µ–±—É–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–æ–¥
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –Ω–∞ –Ω–æ–≤—ã–π email
- ‚úÖ –û—Ç–∑—ã–≤ –≤—Å–µ—Ö refresh —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ —Å–º–µ–Ω–µ email

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ —à–∞–±–ª–æ–Ω–æ–≤

### –ü—Ä–æ–±–ª–µ–º—ã

1. **–°–º–µ—à–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ middleware –ò –≤ –∫–∞–∂–¥–æ–º route
   - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –µ–¥–∏–Ω—ã–π —Å–µ—Ä–≤–∏—Å

2. **–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞**
   - –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å `organizationId`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - **–ö–æ–¥:** `src/app/api/documents/route.ts:108`
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

3. **–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–µ —Å—á—ë—Ç—á–∏–∫–∞ –Ω–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
   - –ï—Å–ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —É–ø–∞–¥—ë—Ç, –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞—Å—Ç—Å—è, –Ω–æ —Å—á—ë—Ç—á–∏–∫ –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prisma.$transaction()`

---

## 5. üßæ –ú–û–î–ï–õ–ò –ò –î–ê–ù–ù–´–ï

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Prisma)

**–ú–æ–¥–µ–ª–∏:**
- ‚úÖ `User` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ `LoginToken` - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∫–æ–¥—ã –¥–ª—è –≤—Ö–æ–¥–∞
- ‚úÖ `Organization` - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `Document` - –¥–æ–∫—É–º–µ–Ω—Ç—ã
- ‚úÖ `DemoStatus` - —Å—Ç–∞—Ç—É—Å –¥–µ–º–æ-–¥–æ—Å—Ç—É–ø–∞
- ‚úÖ `Template` - —à–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ `TemplateConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ —à–∞–±–ª–æ–Ω–æ–≤
- ‚úÖ `AccessHistory` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ `RefreshToken` - refresh —Ç–æ–∫–µ–Ω—ã
- ‚úÖ `EmailVerification` - –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–º–µ–Ω—ã email

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–µ–π

| –°–≤—è–∑—å | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-------|--------|-------------|
| **User ‚Üí Organization** | ‚úÖ | OneToMany, –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |
| **User ‚Üí Document** | ‚úÖ | OneToMany, –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |
| **User ‚Üí DemoStatus** | ‚úÖ | OneToOne |
| **User ‚Üí AccessHistory** | ‚úÖ | OneToMany, –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |
| **User ‚Üí RefreshToken** | ‚úÖ | OneToMany, –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |
| **User ‚Üí EmailVerification** | ‚úÖ | OneToMany, –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |
| **Organization ‚Üí Document** | ‚úÖ | ManyToOne, SetNull –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ |
| **Nullable –ø–æ–ª—è** | ‚úÖ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã (?) |

### –ò–Ω–¥–µ–∫—Å—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:**
- ‚úÖ `User.email` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
- ‚úÖ `User.accessUntil` - –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ `LoginToken.email`, `LoginToken.code`, `LoginToken.token`, `LoginToken.expiresAt`
- ‚úÖ `Organization.userId`, `Organization.inn`, `Organization.subject_type`, `Organization.is_default`
- ‚úÖ `Document.userId`, `Document.templateCode`, `Document.createdAt`
- ‚úÖ `Template.code`, `Template.category`, `Template.isEnabled`
- ‚úÖ `RefreshToken.userId`, `RefreshToken.token`, `RefreshToken.expiresAt`

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã:**
- ‚ö†Ô∏è `Document.organizationId` - –Ω–µ—Ç –∏–Ω–¥–µ–∫—Å–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)

### –ü—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –ø–æ–ª–µ–π**
   - –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `Organization` –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –ò–ù–ù
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å `Organization(userId, inn)`

2. **–ù–µ—Ç –º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è (soft delete)**
   - –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `deletedAt: DateTime?` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## 6. üß∞ –í–ê–õ–ò–î–ê–¶–ò–ò –ò –û–®–ò–ë–ö–ò

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
- ‚úÖ Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ö–µ–º
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –≤ `src/lib/utils/validators.ts`

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

#### –°—Ö–µ–º—ã Zod
- ‚úÖ `createDocumentSchema` - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ `updateDocumentSchema` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ `createOrganizationSchema` - —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–æ—á–µ–Ω—å –ø–æ–¥—Ä–æ–±–Ω–∞—è)
- ‚úÖ `updateOrganizationSchema` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `createTemplateSchema` - —Å–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ `updateUserSchema` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

#### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
- ‚úÖ `validateINN` - –ò–ù–ù —Å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º–æ–π
- ‚úÖ `validateOGRN` - –û–ì–†–ù —Å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º–æ–π
- ‚úÖ `validateBIK` - –ë–ò–ö
- ‚úÖ `validateBankKS` - –∫–æ—Ä—Å—á—ë—Ç —Å –ë–ò–ö
- ‚úÖ `validateBankRS` - —Ä–∞—Å—á—ë—Ç–Ω—ã–π —Å—á—ë—Ç —Å –ë–ò–ö
- ‚úÖ `validatePhone` - —Ç–µ–ª–µ—Ñ–æ–Ω –†–§
- ‚úÖ `validateEmailExtended` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è email

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** | ‚ùå | –ö–∞–∂–¥—ã–π route –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ —Å–∞–º |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ Zod –æ—à–∏–±–æ–∫** | ‚úÖ | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 400 —Å –¥–µ—Ç–∞–ª—è–º–∏ |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ Prisma –æ—à–∏–±–æ–∫** | ‚ö†Ô∏è | –ß–∞—Å—Ç–∏—á–Ω–æ (—Ç–æ–ª—å–∫–æ –≤ admin/templates) |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫** | ‚úÖ | `console.error` –≤–µ–∑–¥–µ |
| **–í–æ–∑–≤—Ä–∞—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π** | ‚úÖ | –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è stack traces |
| **–¢–∏–ø–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫** | ‚ö†Ô∏è | –ß–∞—Å—Ç–∏—á–Ω–æ (—á–µ—Ä–µ–∑ `instanceof`) |

### –ü—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ—à–∏–±–æ–∫**
   - –ö–∞–∂–¥—ã–π route –¥—É–±–ª–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å middleware –∏–ª–∏ wrapper –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

2. **–ù–µ –≤—Å–µ –æ—à–∏–±–∫–∏ Prisma –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è**
   - Unique constraint, Foreign key violations –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Prisma –æ—à–∏–±–æ–∫

3. **–ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—à–∏–±–æ–∫ –≤ Sentry**
   - –ï—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Sentry, –Ω–æ –Ω–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—à–∏–±–æ–∫ –∏–∑ API routes
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Sentry –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫

4. **–í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–µ–∑–¥–µ** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã —á–µ—Ä–µ–∑ `.refine()`
   - ‚úÖ –ò–ù–ù —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã
   - ‚úÖ –ö–ü–ü —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–¥–æ–≤
   - ‚úÖ –û–ì–†–ù/–û–ì–†–ù–ò–ü —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã
   - ‚úÖ –ë–ò–ö —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
   - ‚úÖ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Å—á–µ—Ç–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã
   - ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
   - ‚úÖ Email —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
   - ‚úÖ –§–ò–û —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–∞ —Å—É–±—ä–µ–∫—Ç–∞ (—é—Ä–ª–∏—Ü–æ/–ò–ü) –∏ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤

---

## 7. üì§ –í–ù–ï–®–ù–ò–ï –°–ï–†–í–ò–°–´ –ò –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

#### OpenAI API
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–º–æ–¥–µ–ª—å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, max_tokens)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è API –∫–ª—é—á–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

#### Email (Nodemailer)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Gmail SMTP
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–æ–≤ –¥–ª—è –≤—Ö–æ–¥–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–æ–≤ –¥–ª—è —Å–º–µ–Ω—ã email
- ‚úÖ HTML —à–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º

#### Rate Limiting (Upstash Redis)
- ‚úÖ API rate limiting (100 req/min)
- ‚úÖ Auth rate limiting (5 req/min)
- ‚úÖ AI chat rate limiting (10 req/min)
- ‚úÖ Mock —Ä–µ–∂–∏–º –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ Upstash

### –ü—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API**
   - OpenAI –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –≤–∏—Å–µ—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
   - Email –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `timeout` –¥–ª—è fetch/axios

2. **–ù–µ—Ç retry –º–µ—Ö–∞–Ω–∏–∑–º–∞**
   - –ü—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö OpenAI/Email –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å exponential backoff retry

3. **–•–∞—Ä–¥–∫–æ–¥ SMTP –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Gmail
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Resend/SendGrid

4. **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ rate limit –æ—Ç OpenAI**
   - –ï—Å–ª–∏ OpenAI –≤–µ—Ä–Ω—ë—Ç 429, –æ—à–∏–±–∫–∞ –±—É–¥–µ—Ç –Ω–µ—è—Å–Ω–æ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ OpenAI

5. **Email –æ—à–∏–±–∫–∏ —Å–∫—Ä—ã—Ç—ã**
   - –í `send-code` –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ email –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ —Å–æ–æ–±—â–∞–µ—Ç—Å—è
   - **–ö–æ–¥:** `src/app/api/auth/send-code/route.ts:140-146`
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í production –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (—Ç–æ–ª—å–∫–æ –æ–±—â—É—é –æ—à–∏–±–∫—É)

---

## 8. üß™ –¢–ï–°–¢–´

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–°—Ç–∞—Ç—É—Å:** ‚ùå –¢–µ—Å—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:**

#### Unit —Ç–µ—Å—Ç—ã
- [ ] –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã (`validators.ts`)
- [ ] JWT —É—Ç–∏–ª–∏—Ç—ã (`jwt.ts`)
- [ ] Auth —É—Ç–∏–ª–∏—Ç—ã (`auth-utils.ts`)
- [ ] –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

#### Integration —Ç–µ—Å—Ç—ã
- [ ] API endpoints (happy path)
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è flow
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

#### E2E —Ç–µ—Å—Ç—ã
- [ ] –ü–æ–ª–Ω—ã–π flow –≤—Ö–æ–¥–∞
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF/DOCX
- [ ] –ê–¥–º–∏–Ω—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–ø—Ä–æ–ø—É—â–µ–Ω—ã)

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
   - –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –≤—Ö–æ–¥–∞
   - –ò—Å—Ç—ë–∫—à–∏–π –∫–æ–¥
   - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

2. **–î–æ—Å—Ç—É–ø:**
   - –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –∏—Å—Ç—ë–∫—à–∏–º –¥–æ—Å—Ç—É–ø–æ–º
   - –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –¥–µ–º–æ-–ª–∏–º–∏—Ç–∞
   - –î–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º —Ä–µ—Å—É—Ä—Å–∞–º

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è:**
   - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ò–ù–ù
   - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

---

## 9. ‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| **Connection pooling** | ‚úÖ | Prisma –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pooling |
| **–ò–Ω–¥–µ–∫—Å—ã –ë–î** | ‚úÖ | –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω–¥–µ–∫—Å–∞–º–∏ |
| **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚ö†Ô∏è | –¢–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (React Query 1 –º–∏–Ω) |
| **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** | ‚ùå | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (—Å–º. —Ä–∞–∑–¥–µ–ª API) |
| **Lazy loading** | ‚ö†Ô∏è | –ù–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ |
| **CDN** | ‚úÖ | Next.js –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CDN |
| **Image optimization** | N/A | –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∫–æ–¥–µ |

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

| –ê—Å–ø–µ–∫—Ç | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| **SQL Injection** | ‚úÖ | Prisma ORM –∑–∞—â–∏—â–∞–µ—Ç |
| **XSS** | ‚úÖ | React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç |
| **CSRF** | ‚úÖ | SameSite cookies + HttpOnly |
| **–•–∞—Ä–¥–∫–æ–¥ –ø–∞—Ä–æ–ª–µ–π/–∫–ª—é—á–µ–π** | ‚úÖ | –í—Å–µ –≤ env |
| **Rate limiting** | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ Upstash |
| **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤** | ‚úÖ | HttpOnly cookies |
| **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ headers** | ‚ö†Ô∏è | –ù–µ—Ç —è–≤–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ security headers |

### –ü—Ä–æ–±–ª–µ–º—ã

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**
   - –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è

2. **–ù–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**
   - –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∏–¥—ë—Ç –≤ –ë–î
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å Redis –∫–µ—à –¥–ª—è —Å–ø–∏—Å–∫–æ–≤

3. **–ù–µ—Ç security headers**
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∏–ø–∞ `X-Frame-Options`, `X-Content-Type-Options`
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `next.config.js` –∏–ª–∏ middleware

4. **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ–¥–µ**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –≤ `files/parse` (15 –ú–ë)
   - –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞ –¥–ª—è body

5. **–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
   - –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –º–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ–¥—Ä—è–¥ (rate limit —Ç–æ–ª—å–∫–æ –ø–æ IP)
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

## 10. üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –û–¶–ï–ù–û–ö

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|----------|--------|-------------|
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ | ‚úÖ | –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ UI ‚Üí API ‚Üí Service ‚Üí Data |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã | ‚ö†Ô∏è | –ß–∞—Å—Ç–∏—á–Ω–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ SRP (–ª–æ–≥–∏–∫–∞ –≤ routes) |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | ‚úÖ | –ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ | ‚úÖ | –ö–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | Refresh flow | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å —Ä–æ—Ç–∞—Ü–∏–µ–π —Ç–æ–∫–µ–Ω–æ–≤ |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ | ‚úÖ | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ middleware –∏ –ø—Ä–∏ refresh |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–±—Ö–æ–¥–∞ —Ä–æ–ª–µ–π | ‚úÖ | –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (middleware + route) |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞ | ‚ö†Ô∏è | –í env, –Ω–æ –Ω–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ |
| **API** | GET/POST —Å–∏–º–º–µ—Ç—Ä–∏—è | ‚úÖ | –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã |
| **API** | –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤ | ‚ö†Ô∏è | –ï—Å—Ç—å, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä |
| **API** | –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö | ‚úÖ | Zod —Å—Ö–µ–º—ã –≤–µ–∑–¥–µ |
| **API** | –ü–∞–≥–∏–Ω–∞—Ü–∏—è | ‚ùå | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ |
| **API** | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è | ‚ùå | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** | –í—Å–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è | ‚úÖ | –õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ | ‚ö†Ô∏è | –ù–µ—Ç –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π |
| **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã | ‚ö†Ô∏è | –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ |
| **–ú–æ–¥–µ–ª–∏** | –°–≤—è–∑–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã | ‚úÖ | –í—Å–µ —Å–≤—è–∑–∏ OneToMany/ManyToOne –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã |
| **–ú–æ–¥–µ–ª–∏** | Nullable –ø–æ–ª—è | ‚úÖ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã |
| **–ú–æ–¥–µ–ª–∏** | –ò–Ω–¥–µ–∫—Å—ã | ‚úÖ | –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω–¥–µ–∫—Å–∞–º–∏ |
| **–ú–æ–¥–µ–ª–∏** | –ú–∏–≥—Ä–∞—Ü–∏–∏ | ‚úÖ | –ï—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `prisma/migrations/` |
| **–í–∞–ª–∏–¥–∞—Ü–∏–∏** | DTO –≤–∞–ª–∏–¥–∞—Ü–∏—è | ‚úÖ | Zod —Å—Ö–µ–º—ã –≤–µ–∑–¥–µ |
| **–í–∞–ª–∏–¥–∞—Ü–∏–∏** | –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã | ‚ö†Ô∏è | –ï—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–µ–∑–¥–µ |
| **–í–∞–ª–∏–¥–∞—Ü–∏–∏** | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | ‚ö†Ô∏è | –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| **–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã** | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | ‚ö†Ô∏è | –ù–µ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ retry |
| **–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã** | Fallback | ‚ö†Ô∏è | –¢–æ–ª—å–∫–æ –¥–ª—è rate limiting (mock) |
| **–¢–µ—Å—Ç—ã** | Unit —Ç–µ—Å—Ç—ã | ‚ùå | –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **–¢–µ—Å—Ç—ã** | Integration —Ç–µ—Å—Ç—ã | ‚ùå | –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **–¢–µ—Å—Ç—ã** | E2E —Ç–µ—Å—Ç—ã | ‚ùå | –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ü–∞–≥–∏–Ω–∞—Ü–∏—è | ‚ùå | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚ö†Ô∏è | –¢–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ò–Ω–¥–µ–∫—Å—ã | ‚úÖ | –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | SQL Injection | ‚úÖ | Prisma –∑–∞—â–∏—â–∞–µ—Ç |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | XSS | ‚úÖ | React –∑–∞—â–∏—â–∞–µ—Ç |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | CSRF | ‚úÖ | SameSite cookies |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | Rate limiting | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | Security headers | ‚ö†Ô∏è | –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —è–≤–Ω–æ |

**–õ–µ–≥–µ–Ω–¥–∞:**
- ‚úÖ - –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ / –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚ö†Ô∏è - –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è / –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚ùå - –ö—Ä–∏—Ç–∏—á–Ω–æ / –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å)

1. **–î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤**
   - `GET /api/documents` - –¥–æ–±–∞–≤–∏—Ç—å `?page=1&limit=20`
   - `GET /api/organizations` - –¥–æ–±–∞–≤–∏—Ç—å `?page=1&limit=20`
   - `GET /api/admin/access` - –¥–æ–±–∞–≤–∏—Ç—å `?page=1&limit=20`

2. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `organizationId`

3. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã (–º–∏–Ω–∏–º—É–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ)**
   - –û—Å–Ω–æ–≤–Ω—ã–µ API endpoints
   - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è flow
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### –í–∞–∂–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)

4. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
   - Middleware –∏–ª–∏ wrapper –¥–ª—è –≤—Å–µ—Ö routes
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sentry

5. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
   - –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ + –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á—ë—Ç—á–∏–∫–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ email + –æ—Ç–∑—ã–≤ —Ç–æ–∫–µ–Ω–æ–≤

6. **–¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API**
   - OpenAI –∑–∞–ø—Ä–æ—Å—ã
   - Email –æ—Ç–ø—Ä–∞–≤–∫–∞

7. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤**
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å `validateINN`, `validateOGRN` –≤ —Å—Ö–µ–º–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ)

8. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**
   - Redis –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ —à–∞–±–ª–æ–Ω–æ–≤
   - –ö–µ—à –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

9. **Security headers**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `next.config.js`

10. **Soft delete**
    - –î–æ–±–∞–≤–∏—Ç—å `deletedAt` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç **—Ö–æ—Ä–æ—à—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –æ—Å–Ω–æ–≤—É** –∏ **–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π**. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å:

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º —Ç–µ—Å—Ç–æ–≤** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏–∏** - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫** - –Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:** 75%

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–µ—Ä–µ–¥ production –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ—à–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ç–µ—Å—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã).

---

**–ê—É–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω:** 2025-01-28  
**–ê—É–¥–∏—Ç–æ—Ä:** AI Code Analyzer

