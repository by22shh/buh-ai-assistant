# üíæ –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –†–ï–ó–ï–†–í–ù–û–ú–£ –ö–û–ü–ò–†–û–í–ê–ù–ò–Æ

**–í–µ—Ä—Å–∏—è:** v25
**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025

---

## üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø BACKUP

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã (Neon)

**Neon PostgreSQL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç snapshot –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
- ‚úÖ –•—Ä–∞–Ω–∏—Ç snapshots 7 –¥–Ω–µ–π (Free tier)
- ‚úÖ –•—Ä–∞–Ω–∏—Ç snapshots 30 –¥–Ω–µ–π (Pro tier)
- ‚úÖ Point-in-time recovery (PITR) –¥–æ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥

**–ù–∏—á–µ–≥–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!** –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏.

---

## üìã MANUAL BACKUPS

### –ö–æ–≥–¥–∞ –¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é:

1. **–ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π –ë–î**
2. **–ü–µ—Ä–µ–¥ –±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏**
3. **–ü–µ—Ä–µ–¥ production deploy**
4. **–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é** (–¥–ª—è –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

---

## üîß –ö–ê–ö –°–û–ó–î–ê–¢–¨ BACKUP

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Neon Dashboard (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://console.neon.tech/
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Backups** –∏–ª–∏ **Branches**
4. –ù–∞–∂–º–∏—Ç–µ **Create Branch**
5. –ù–∞–∑–æ–≤–∏—Ç–µ –≤–µ—Ç–∫—É: `backup-2025-10-19` –∏–ª–∏ `before-migration`
6. –ì–æ—Ç–æ–≤–æ! Snapshot —Å–æ–∑–¥–∞–Ω

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ branch —Å backup
2. **Restore** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ target branch
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: pg_dump (Export –≤ —Ñ–∞–π–ª)

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ pg_dump:**
```bash
# Ubuntu/Debian
sudo apt-get install postgresql-client

# macOS
brew install postgresql
```

**–°–æ–∑–¥–∞–Ω–∏–µ backup:**
```bash
# 1. –ü–æ–ª—É—á–∏—Ç–µ DATABASE_URL –∏–∑ .env
DATABASE_URL="postgresql://user:password@ep-xxx.region.neon.tech/dbname"

# 2. –°–æ–∑–¥–∞–π—Ç–µ backup
pg_dump "$DATABASE_URL" > backup-$(date +%Y-%m-%d).sql

# 3. –°–æ–∂–º–∏—Ç–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
gzip backup-$(date +%Y-%m-%d).sql
```

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```bash
# 1. –†–∞—Å–ø–∞–∫—É–π—Ç–µ (–µ—Å–ª–∏ —Å–∂–∞—Ç–æ)
gunzip backup-2025-10-19.sql.gz

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
psql "$DATABASE_URL" < backup-2025-10-19.sql
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: Prisma Migrate (Schema —Ç–æ–ª—å–∫–æ)

**Backup schema:**
```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ö–µ–º—É
bunx prisma db pull
# ‚Üí –æ–±–Ω–æ–≤–∏—Ç prisma/schema.prisma

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –≤ Git
git add prisma/schema.prisma
git commit -m "backup: schema before migration"
```

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ schema:**
```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å schema
git checkout HEAD~1 -- prisma/schema.prisma

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å
bunx prisma migrate dev --name rollback
```

---

## üóìÔ∏è –†–ê–°–ü–ò–°–ê–ù–ò–ï BACKUP

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (Neon):
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π snapshot (00:00 UTC)
- **Retention:** 7 –¥–Ω–µ–π (Free), 30 –¥–Ω–µ–π (Pro)

### –†—É—á–Ω—ã–µ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:** –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤–µ—á–µ—Ä–æ–º
- **–ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π:** –ö–∞–∂–¥—ã–π —Ä–∞–∑
- **–ü–µ—Ä–µ–¥ deploy:** –ö–∞–∂–¥—ã–π production deploy
- **–ü–µ—Ä–µ–¥ –±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:** –ü–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

## üì¶ –ì–î–ï –•–†–ê–ù–ò–¢–¨ BACKUPS

### –í–∞—Ä–∏–∞–Ω—Ç 1: Git (–¥–ª—è schema)
```bash
git add prisma/schema.prisma prisma/migrations/
git commit -m "backup: database schema"
git push
```

‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–∞–Ω–Ω—ã—Ö (—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ)

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Cloud Storage

**Google Drive / Dropbox:**
```bash
# –°–æ–∑–¥–∞—Ç—å backup
pg_dump "$DATABASE_URL" | gzip > backup.sql.gz

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ Google Drive
```

**AWS S3:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å AWS CLI
bun add -g aws-cli

# –°–æ–∑–¥–∞—Ç—å backup –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å
pg_dump "$DATABASE_URL" | gzip | aws s3 cp - s3://my-backups/db-$(date +%Y-%m-%d).sql.gz
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å:**
- Google Drive: 15 GB –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- Dropbox: 2 GB –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- AWS S3: ~$0.023/GB/–º–µ—Å—è—Ü

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –õ–æ–∫–∞–ª—å–Ω–æ

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p ~/backups/buh-ai-assistant

# Backup —Å –¥–∞—Ç–æ–π
pg_dump "$DATABASE_URL" | gzip > ~/backups/buh-ai-assistant/backup-$(date +%Y-%m-%d).sql.gz

# –£–¥–∞–ª—è—Ç—å backups —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
find ~/backups/buh-ai-assistant -name "*.sql.gz" -mtime +30 -delete
```

‚úÖ –ë—ã—Å—Ç—Ä–æ
‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
‚ùå –ù–µ –∑–∞—â–∏—â–µ–Ω–æ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞

---

## üî• DISASTER RECOVERY

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ï—Å–ª–∏ < 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥:**
1. Neon Dashboard ‚Üí Branches
2. Create branch from `main` –Ω–∞ –º–æ–º–µ–Ω—Ç –¥–æ —É–¥–∞–ª–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–µ
4. Restore –µ—Å–ª–∏ –≤—Å—ë –û–ö

**–ï—Å–ª–∏ > 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥:**
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ pg_dump backup
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å recent –º–∏–≥—Ä–∞—Ü–∏–∏

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–ª–æ—Ö–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

**–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è —Å–ª–æ–º–∞–ª–∞ –¥–∞–Ω–Ω—ã–µ:**
```bash
# 1. –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
git revert HEAD

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ Neon branch
# Neon Dashboard ‚Üí Restore before migration

# 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é
bunx prisma migrate dev --name fix
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è –ë–î

**–†–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç:**

1. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î –≤ Neon**
2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å schema:**
   ```bash
   bunx prisma migrate deploy
   ```
3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:**
   ```bash
   psql "$NEW_DATABASE_URL" < latest-backup.sql
   ```
4. **–û–±–Ω–æ–≤–∏—Ç—å .env:**
   ```env
   DATABASE_URL="–Ω–æ–≤—ã–π_url"
   ```

---

## ‚úÖ CHECKLIST

### –ü–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π:
- [ ] –°–æ–∑–¥–∞—Ç—å Neon branch —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- [ ] –°–¥–µ–ª–∞—Ç—å pg_dump backup
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ backup —É—Å–ø–µ—à–µ–Ω
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å backup –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ
- [ ] –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ backups (>30 –¥–Ω–µ–π)

---

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–≤—Ç–æ–±—ç–∫–∞–ø—ã Neon —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –°–æ–∑–¥–∞—Ç—å pg_dump backup
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ Google Drive / S3
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)

---

## üîß –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø

### GitHub Actions (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π backup):

```yaml
# .github/workflows/backup.yml
name: Weekly Database Backup

on:
  schedule:
    - cron: '0 0 * * 0' # –ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 00:00

jobs:
  backup:
    runs-on: ubuntu-latest
    steps:
      - name: Install PostgreSQL Client
        run: sudo apt-get install -y postgresql-client

      - name: Create Backup
        env:
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
        run: |
          pg_dump "$DATABASE_URL" | gzip > backup-$(date +%Y-%m-%d).sql.gz

      - name: Upload to Artifacts
        uses: actions/upload-artifact@v3
        with:
          name: database-backup
          path: backup-*.sql.gz
          retention-days: 30
```

---

### Cron job (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab
crontab -e

# Backup –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 03:00
0 3 * * 0 pg_dump "$DATABASE_URL" | gzip > ~/backups/backup-$(date +\%Y-\%m-\%d).sql.gz
```

---

## üí° BEST PRACTICES

### 1. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –†–∞–∑ –≤ –º–µ—Å—è—Ü –ø—Ä–æ–±—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backup
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç–∞–µ—Ç

### 2. –•—Ä–∞–Ω–∏—Ç–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- Neon branches (7-30 –¥–Ω–µ–π)
- Cloud storage (Google Drive / S3)
- –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
- –ö–æ–≥–¥–∞ —Å–¥–µ–ª–∞–Ω backup
- –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è
- –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

### 4. –®–∏—Ñ—Ä—É–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```bash
# Backup —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
pg_dump "$DATABASE_URL" | gzip | gpg -c > backup-encrypted.sql.gz.gpg

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
gpg -d backup-encrypted.sql.gz.gpg | gunzip | psql "$DATABASE_URL"
```

---

## üìä MONITORING

### –ü—Ä–æ–≤–µ—Ä–∫–∞ backups:

**Neon Dashboard:**
1. Console ‚Üí Project ‚Üí Backups
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ snapshot
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ storage –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω

**CLI:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ë–î
psql "$DATABASE_URL" -c "SELECT pg_size_pretty(pg_database_size(current_database()));"

# –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –∏ —Ä–∞–∑–º–µ—Ä—ã
psql "$DATABASE_URL" -c "SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) FROM pg_tables WHERE schemaname='public';"
```

---

## üéØ SUMMARY

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. ‚úÖ Neon –∞–≤—Ç–æ–±—ç–∫–∞–ø—ã —Ä–∞–±–æ—Ç–∞—é—Ç ‚Üí –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å
2. ‚úÖ –ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π ‚Üí —Å–æ–∑–¥–∞—Ç—å Neon branch
3. ‚úÖ –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é ‚Üí pg_dump –≤ Google Drive
4. ‚úÖ –†–∞–∑ –≤ –º–µ—Å—è—Ü ‚Üí —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å restore

**–ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å:**
- ‚ùå –ü–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ Neon (–º–æ–≥—É—Ç –±—ã—Ç—å —Å–±–æ–∏)
- ‚ùå –•—Ä–∞–Ω–∏—Ç—å backups —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
- ‚ùå –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚ùå –ó–∞–±—ã–≤–∞—Ç—å –¥–µ–ª–∞—Ç—å backup –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π

---

**Backups = —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ! üíæ**
